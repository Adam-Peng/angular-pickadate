!function(e){"use strict";function t(e,t){for(var a=t.parentNode;null!==a;){if(a===e)return!0;a=a.parentNode}return!1}var a=[].indexOf||function(e){for(var t=0,a=this.length;a>t;t++)if(t in this&&this[t]===e)return t;return-1};e.module("pickadate",[]).provider("pickadateI18n",function(){var e={prev:"prev",next:"next"};this.translations={},this.$get=function(){var t=this.translations;return{t:function(a){return t[a]||e[a]}}}}).factory("pickadateUtils",["$locale",function(t){return{stringToDate:function(t){if(t){if(e.isDate(t))return new Date(t);var a=t.split("-"),n=a[0],i=a[1],r=a[2];return new Date(n,i-1,r,3)}},buildDates:function(e,t){var a=[],n=new Date(e.getFullYear(),e.getMonth()+1,0,3);for(t=t||{},e=new Date(e);e.getDay()!==t.weekStartsOn;)e.setDate(e.getDate()-1);for(var i=0;42>i&&!(t.noExtraRows&&e.getDay()===t.weekStartsOn&&e>n);i++)a.push(new Date(e)),e.setDate(e.getDate()+1);return a},buildDayNames:function(e){var a=t.DATETIME_FORMATS.SHORTDAY;if(e){a=a.slice(0);for(var n=0;e>n;n++)a.push(a.shift())}return a}}}]).directive("pickadate",["$locale","$sce","$compile","$document","$window","pickadateUtils","pickadateI18n","dateFilter",function(n,i,r,s,l,c,d,o){var u='<div class="pickadate" ng-show="displayPicker" ng-style="styles"><div class="pickadate-header"><div class="pickadate-controls"><a href="" class="pickadate-prev" ng-click="changeMonth(-1)" ng-show="allowPrevMonth">'+i.trustAsHtml(d.t("prev"))+'</a><a href="" class="pickadate-next" ng-click="changeMonth(1)" ng-show="allowNextMonth">'+i.trustAsHtml(d.t("next"))+'</a></div><h3 class="pickadate-centered-heading">{{currentDate | date:"MMMM yyyy"}}</h3></div><div class="pickadate-body"><div class="pickadate-main"><ul class="pickadate-cell"><li class="pickadate-head" ng-repeat="dayName in dayNames">{{dayName}}</li></ul><ul class="pickadate-cell"><li ng-repeat="d in dates" ng-click="setDate(d)" ng-class="classesFor(d)">{{d.dateObj | date:"d"}}</li></ul></div></div></div>';return{require:"ngModel",scope:{defaultDate:"=",minDate:"=",maxDate:"=",disabledDates:"=",weekStartsOn:"="},link:function(n,i,d,p){function f(){var e=new Date(n.currentDate.getFullYear(),n.currentDate.getMonth(),1,3),t=e.getMonth()+1,a=c.buildDates(e,{weekStartsOn:$,noExtraRows:m}),i=[],r=o(new Date,"yyyy-MM-dd"),s=new Date(e);s.setMonth(t),n.allowPrevMonth=!y||e>y,n.allowNextMonth=!k||k>=s,n.dayNames=c.buildDayNames($);for(var l=0;l<a.length;l++){var d=[],u=a[l],p=o(u,"yyyy-MM-dd"),f=g(p);d.push(v(u)||f?"pickadate-disabled":"pickadate-enabled"),f&&d.push("pickadate-unavailable"),p===r&&d.push("pickadate-today"),i.push({date:p,dateObj:u,classNames:d})}n.dates=i}function h(e){p.$setViewValue(M?e:e[0]),i.val(p.$viewValue)}function D(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];g(n)||v(c.stringToDate(n))||t.push(n)}return t}function v(e){return y>e||e>k||o(e,"M")!==o(n.currentDate,"M")}function g(e){return a.call(n.disabledDates||[],e)>=0}function w(e,t){var n=a.call(t,e);return-1===n?t.push(e):t.splice(n,1),t}var y,k,m=d.hasOwnProperty("noExtraRows"),M=d.hasOwnProperty("multiple"),$=n.weekStartsOn,b=[],x=i[0]instanceof HTMLInputElement,N=r(u)(n);n.displayPicker=!x,(!e.isNumber($)||0>$||$>6)&&($=0),n.setDate=function(e){v(e.dateObj)||g(e.date)||(b=M?w(e.date,b):[e.date],h(b),n.displayPicker=!x)};var O=p.$render=function(){e.isArray(p.$viewValue)?b=p.$viewValue:p.$viewValue&&(b=[p.$viewValue]),n.currentDate=c.stringToDate(n.defaultDate)||c.stringToDate(b[0])||new Date,b=D(b),h(b),f()};if(n.classesFor=function(e){var t=a.call(b,e.date)>=0?"pickadate-active":null;return e.classNames.concat(t)},n.changeMonth=function(e){n.currentDate.setDate(1),n.currentDate.setMonth(n.currentDate.getMonth()+e),f()},n.$watch(function(){return e.toJson([n.minDate,n.maxDate,n.disabledDates])},function(){y=c.stringToDate(n.minDate)||new Date(0),k=c.stringToDate(n.maxDate)||new Date(99999999999999),O()}),x){var T=function(e){n.displayPicker=e,n.$apply()};i.on("focus",function(){var e=l.innerWidth||s.documentElement.clientWidth||s.body.clientWidth;n.styles={top:i[0].getBoundingClientRect().bottom+"px"},e-i[0].getBoundingClientRect().left>=300?n.styles.left=i[0].getBoundingClientRect().left+"px":n.styles.right=e-i[0].getBoundingClientRect().right+"px",T(!0)}),i.on("keydown",function(e){(27===e.keyCode||9===e.keyCode)&&T(!1)}),n.$watch(function(){return p.$viewValue},function(e){var t=/^\d{4}-\d{1,2}-\d{1,2}$/.test(e);t&&O(),p.$setValidity("date",t)}),s.on("click",function(e){t(N[0],e.target)||e.target===i[0]||T(!1)}),i.after(N.addClass("pickadate-modal"))}else i.append(N)}}}])}(window.angular);